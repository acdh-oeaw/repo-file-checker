## phpMusselのドキュメンテーション（日本語）。

### 目次
- 1. [序文](#SECTION1)
- 2. [インストール方法](#SECTION2)
- 3. [使用方法](#SECTION3)
- 4. [フロントエンドの管理](#SECTION4)
- 5. [CLI （コマンドライン・インターフェイス）](#SECTION5)
- 6. [本パッケージに含まれるファイル](#SECTION6)
- 7. [設定オプション](#SECTION7)
- 8. [シグネチャ（署名）フォーマット](#SECTION8)
- 9. [適合性問題](#SECTION9)
- 10. [よくある質問（FAQ）](#SECTION10)

*翻訳についての注意： エラーが発生した場合（例えば、翻訳の間の不一致、タイプミス、等等）、READMEの英語版が原本と権威のバージョンであると考えられます。 誤りを見つけた場合は、それらを修正するにご協力を歓迎されるだろう。*

---


### 1. <a name="SECTION1"></a>序文

phpMussel（ピー・エイチ・ピー・マッスル）をご利用頂き、ありがとうございます。 phpMusselは、ClamAV をはじめとしたシグネチャを利用して、システムにアップロードされるファイルを対象して、トロイ型のウィルスやマルウェア等を検出するようデザインされたPHPスクリプトです。

PHPMUSSEL著作権2013とGNU一般公衆ライセンスv2を超える権利について： Caleb M (Maikuolan)著。

本スクリプトはフリーウェアです。フリーソフトウェア財団発行のGNU一般公衆ライセンス・バージョン２（またはそれ以降のバージョン）に従い、再配布ならびに加工が可能です。配布の目的は、役に立つことを願ってのものですが、『保証はなく、また商品性や特定の目的に適合するのを示唆するものでもありません』。 『LICENSE.txt』にある『GNU General Public License』（一般ライセンス）を参照して下さい。 以下のURLからも閲覧できます：
- <http://www.gnu.org/licenses/>。
- <http://opensource.org/licenses/>。

作成のインスピレーションと本スクリプトが利用するシグネチャについて[ClamAV](http://www.clamav.net/)に感謝の意を表したいと思います。 この２つがなければ、本スクリプトは存在しえないか、あるいは極めて限られた利用価値しかもたないと言ってよいでしょう。

本プロジェクトファイルのホスト先であるSourceforgeとGitHub、 phpMusselのディスカッションフォーラムのホスト先である[Spambot Security](http://www.spambotsecurity.com/forum/viewforum.php?f=55)、 phpMusselが利用するシグネチャの提供先である： [SecuriteInfo.com](http://www.securiteinfo.com/)、 [PhishTank](http://www.phishtank.com/)、 [NLNetLabs](http://nlnetlabs.nl/) 他、 本プロジェクトを支援して下さった全ての方々に感謝の意を表したいと思います。

本ドキュメントならびに関連パッケージは以下のURLからダウンロードできます。
- [Sourceforge](http://phpmussel.sourceforge.net/)。
- [GitHub](https://github.com/Maikuolan/phpMussel/)。

---


### 2. <a name="SECTION2"></a>インストール方法

#### 2.0 手動インストール（ウェブサーバー編）

1) 本項を読んでいるということから、アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。 ホストあるいはCMSに`/public_html/phpmussel/`のようなディレクトリを作り、ローカルマシンからそこにコンテンツをアップロードするのが次のステップです。アップロード先のディレクトリ名や場所については、安全でさえあれば、もちろん制約などはありませんので、自由に決めて下さい。

2) `config.ini`に`config.ini.RenameMe`の名前を変更します（`vault`の内側に位置する）。 オプションの修正のため（初心者には推奨できませんが、経験が豊富なユーザーには強く推奨します）、それを開いて下さい（本ファイルはphpMusselが利用可能なディレクティブを含んでおり、それぞれのオプションについての機能と目的に関した簡単な説明があります）。 セットアップ環境にあわせて、適当な修正を行いファイルを保存して下さい。

3) コンテンツ（phpMussel本体とファイル）を先に定めたディレクトリにアップロードします。 （`*.txt`や`*.md`ファイルはアップロードの必要はありませんが、大抵は全てをアップロードしてもらって構いません）。

4) `vault`ディレクトリは「７５５」にアクセス権変更します（問題がある場合は、「７７７」を試すことができます；これは、しかし、安全ではありません）。 コンテンツをアップロードしたディレクトリそのものは、通常特に何もする必要ありませんが、過去にパーミッションで問題があった場合、CHMODのステータスは確認しておくと良いでしょう。 （デフォルトでは「７５５」が一般的です）。

5) 次に、システム内あるいはCMSにphpMusselをフックします。方法はいくつかありますが、最も容易なのは、`require`や`include`でスクリプトをシステム内またはCMSのコアファイルの最初の部分に記載する方法です。（コアファイルとは、サイト内のどのページにアクセスがあっても必ずロードされるファイルのことです）。 一般的には、`/includes`や`/assets`や`/functions`のようなディレクトリ内のファイルで、`init.php`、`common_functions.php`、`functions.php`といったファイル名が付けられています。実際にどのファイルなのかは、見つけてもうらう必要があります。 よく分からない場合は、phpMusselサポートフォーラムを参照するか、またはGitHubのでphpMusselの問題のページ、あるいはお知らせください（CMS情報必須）。 私自身を含め、ユーザーの中に類似のCMSを扱った経験があれば、何かしらのサポートを提供できます。コアファイルが見つかったなら、「`require`か`include`を使って」以下のコードをファイルの先頭に挿入して下さい。 ただし、クォーテーションマークで囲まれた部分は`loader.php`ファイルの正確なアドレス（HTTPアドレスでなく、ローカルなアドレス。前述のvaultのアドレスに類似）に置き換えます。

`<?php require '/user_name/public_html/phpmussel/loader.php'; ?>`

ファイルを保存して閉じ、再アップロードします。

-- 他の手法 --

Apacheウェブサーバーを利用していて、かつ`php.ini`を編集できるようであれば、`auto_prepend_file`ディレクティブを使って、PHPリクエストがあった場合にはいつもphpMusselを先頭に追加するようにすることも可能です。以下に例を挙げます。

`auto_prepend_file = "/user_name/public_html/phpmussel/loader.php"`

あるいは、`.htaccess` において：

`php_value auto_prepend_file "/user_name/public_html/phpmussel/loader.php"`

6) これでインストールは完了ですが、念のために、テストを行いましょう。 不正ファイルアップロード保護機能をテストするには、パッケージ内の`_testfiles`に含まれているテストファイルをブラウザを使った通常の方法でアップロードします。 問題がなければ、phpMusselからアップロードをブロックしたとのメッセージが表示され、そうでない場合は何かが正常に機能していません。また、もし何かしら特殊な機能を使っている、ないしは他のタイプのスキャニングも使っているようであれば、相互に影響があるかないかもチェックしておく方が良いでしょう。

#### 2.1 手動インストール（CLI編）

1) 本項を読んでいるということから、アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。 phpmusselの保存場所が決まったら、次へ進んで下さい。

2) phpMusselを使うには、PHPがホストマシンにインストールされている必要があります。 もし、まだであれば、各種PHPインストーラーのどれを使っても構いませんので、インストールして下さい。

3) オプションの修正のため（初心者には推奨できませんが、経験が豊富なユーザーには強く推奨します）。 `vault`内の`config.ini`を開いて下さい。本ファイルはphpMusselが利用可能なディレクティブを含んでおり、それぞれのオプションについての機能と目的に関した簡単な説明があります。 セットアップ環境にあわせて、適当な修正を行いファイルを保存して下さい。

4) オプションですが、バッチファイルを作成することにより、phpMusselのCLIモードでの使用を容易にすることができます。 バッチファイルはPHPとphpMusselを自動的にロードするものです。 まず、Notepadか Notepad++のようなテキストエディタを開いて下さい。 そして、インストールしたPHPの`php.exe`の絶対パス、半角スペース、`loader.php`の絶対パスをタイプして、拡張子「.bat」でファイルを目につくところに保存します。 このファイルをダブルクリックすることでphpMusselを起動することができます。

5) テストを行いましょう。 パッケージ内の`_testfiles`をphpMusselでスキャンしてみて下さい。

#### 2.2 COMPOSERを使用してインストールする

[phpMusselはPackagistに登録されています](https://packagist.org/packages/maikuolan/phpmussel)。 Composerを使い慣れている場合は、Composerを使用してphpMusselをインストールできます （あなたはまだ設定とフックを準備する必要があります； 「手動インストール（ウェブサーバー編）」の手順2と5を参照してください）。

`composer require maikuolan/phpmussel`

---


### 3. <a name="SECTION3"></a>使用方法

#### 3.0 使用方法（ウェーブサーバー編）

phpMusselは特別な使用環境を必要としないスクリプトです。 一度インストールされれば、充分に機能します。

デフォルトでは、アップロードされたファイルのスキャンは自動的に行うように設定されています。 従って基本的に何もすることはありません。

ですが、特定のファイル、ディレクトリ、アーカイブをスキャンするよう設定することも可能です。 `config.ini`を適切に設定し直して下さい（クリーンアップは無効でなくてはなりません）。 その後phpMusselがフックされているPHPファイル内において、以下のコードを使用します。

`$phpMussel['Scan']($what_to_scan, $output_type, $output_flatness);`

- `$what_to_scan` には、文字列あるいは（多次元）配列を代入することができます。 どのファイル（一つないしは複数）あるいはディレクトリ（一つないしは複数）をスキャンすべきか指定します。
- `$output_type` はブーレアンで、スキャン結果のフォーマットを指定できます。 `false`は結果を整数型で返します（ー３は、phpMusselのシグネチャファイルかシグネチャマップがない、もしくは破損している可能性があることを示しています。 ー２はスキャン中に破損データを検出したためスキャン失敗、ー１はPHPがスキャンに必要な拡張子あるいはアドオンがないためにスキャン失敗、０はスキャンの対象が存在しないこと、１は対象のスキャンを完了しかつ問題がないこと、２は対象のスキャンを完了しかつ問題を検出したことを意味します）。 `true`（真）は結果をテキスト形式で返します。 どちらを選択しても、スキャン後にグローバル変数によって結果にアクセスすることが可能です。 `$output_type`はオプションでデフォルト設定は`false`（偽）になっています。
- `$output_flatness` はブーレアンで、スキャン結果を配列で返すか、文字列で返すかを指定します（対象が複数の場合）。 `false`（偽）は配列、`true`（真）は文字列での返り値となります。 `$output_flatness`はオプションでデフォルト設定は`false`（偽）です。

例：

```PHP
 $results = $phpMussel['Scan']('/user_name/public_html/my_file.html', true, true);
 echo $results;
```

の場合、返り値は：

```
 Wed, 16 Sep 2013 02:49:46 +0000 開始。
 > チェック '/user_name/public_html/my_file.html':
 -> 問題は検出されませんでした。
 Wed, 16 Sep 2013 02:49:47 +0000 完了。
```

phpMusselがどのようなシグネチャを使ったか等の詳細な情報については、本ファイルのセクション『シグネチャフォーマット』を参照して下さい。

誤検出や新種の疑わしきものに遭遇した、あるいはシグネチャに関することについては何でもお知らせ下さい。 そうすれば、即時対応でき、必要な修正を行うことができます。

phpMusselに含まれるシグネチャを無効にするには、本READMEファイルの「フロントエンドの管理」内にあるグレーリスティング・ノートを参照して下さいを参照して下さい（通常除かれるべきではないと考えられるものがブロックされてしまうような場合）。

#### 3.1 使用方法（CLI編）

本READMEファイルの「手動インストール（CLI編）」を参照して下さい。

将来的にはウィンドウズベース以外のシステムもサポートする予定ですが、現バージョンのphpMussel CLIモードではウィンドウズベースのみです。 （試して頂いたくことに問題はありません。 ただ期待通りの機能を保証することはできない旨ご了承下さい）。

なお、phpMusselを通常のウィルスソフトと混同しないで下さい。アクティブメモリーを監視してウィルスを即時検出するものではありません（phpMusselは、オンデマンドスキャナです；phpMusselは、オンアクセススキャナではありません）。 指定されたファイルのみをスキャンし（また、ファイルのアップロード）、含まれるウィルスを検出します。

---


### 4. <a name="SECTION4"></a>フロントエンドの管理

#### 4.0 フロントエンドは何です。

フロントエンドは、phpMusselのインストールを維持、管理、更新するための便利で簡単な方法を提供します。 ログページを使用してログファイルを表示、共有、ダウンロードすることができます、コンフィギュレーションページでコンフィギュレーションを変更できます、アップデートページを使用してコンポーネントをインストールおよびアンインストールできます、そして、ファイル・マネージャーを使用してvault「ボールト」内のファイルをアップロード、ダウンロード、および変更することができます。

不正アクセスを防止するため、フロントエンドはデフォルトで無効になっています （不正アクセスがウェブサイトとそのセキュリティに重大な影響を与える可能性があります）。 それを可能にするための指示は、このパラグラフの下に含まれています。

#### 4.1 フロントエンドを有効にする方法。

1) `config.ini`の中にある`disable_frontend`ディレクティブを探します、それを「`false`」に設定します （デフォルトでは「`true`」です）。

2) ブラウザから`loader.php`にアクセスしてください （例えば、`http://localhost/phpmussel/loader.php`）。

3) デフォルトのユーザー名とパスワードでログインする （admin/password）。

注意： あなたが初めてログインした後、フロントエンドへの不正アクセスを防ぐために、あなたはすぐにユーザー名とパスワードを変更する必要があります！ これは非常に重要です、なぜなら、フロントエンドから任意のPHPコードをあなたのウェブサイトにアップロードすることができるからです。

#### 4.2 フロントエンドの使い方。

フロントエンドの各ページには、目的の説明とその使用方法の説明があります。 詳しい説明や特別な支援が必要な場合は、サポートにお問い合わせください。 また、デモを提供するYouTube上で利用可能な動画もあります。


---


### 5. <a name="SECTION5"></a>CLI （コマンドライン・インターフェイス）

phpMusselはウィンドウズベースのシステムでは、CLIモードで対話式のファイルスキャナーとしても機能します。詳細についてはインストール方法（CLI編）を参照して下さい。

CLIプロンプトにて`c`とタイプしエンターを押せば、利用可能なCLIコマンドのリストが表示されます。

また、興味のある人のために、CLIモードでphpMusselを使用する方法のためのビデオチュートリアルは、ここで提供されています：
- <https://www.youtube.com/watch?v=H-Pa740-utc>

---


### 6. <a name="SECTION6"></a>本パッケージに含まれるファイル

以下はアーカイブから一括ダウンロードされるファイルのリスト、ならびにスクリプト使用により作成されるファイルとこれらのファイルが何のためかという簡単な説明です。

ファイル | 説明
----|----
/_docs/ | ドキュメンテーション用のディレクトリです（様々なファイルを含みます）。
/_docs/readme.ar.md | アラビア語ドキュメンテーション。
/_docs/readme.de.md | ドイツ語ドキュメンテーション。
/_docs/readme.en.md | 英語ドキュメンテーション。
/_docs/readme.es.md | スペイン語ドキュメンテーション。
/_docs/readme.fr.md | フランス語ドキュメンテーション。
/_docs/readme.id.md | インドネシア語ドキュメンテーション。
/_docs/readme.it.md | 伊語ドキュメンテーション。
/_docs/readme.ja.md | 日本語ドキュメンテーション。
/_docs/readme.ko.md | 韓国語ドキュメンテーション。
/_docs/readme.nl.md | オランダ語ドキュメンテーション。
/_docs/readme.pt.md | ポルトガル語ドキュメンテーション。
/_docs/readme.ru.md | ロシア語ドキュメンテーション。
/_docs/readme.ur.md | ウルドゥー語ドキュメンテーション。
/_docs/readme.vi.md | ベトナム語ドキュメンテーション。
/_docs/readme.zh-TW.md | 繁体字中国語ドキュメンテーション。
/_docs/readme.zh.md | 簡体字中国語ドキュメンテーション。
/_testfiles/ | テストファイルのディレクトリです（様々なファイルを含んでいます）。phpMusselがシステムに正しくインストールされたかどうかをテストするファイルです。テスト以外の目的でこのディレクトリをアップロードすることはありません。
/_testfiles/ascii_standard_testfile.txt | phpMussel正規化ASCIIシグネチャ用テストファイル。
/_testfiles/coex_testfile.rtf | phpMussel拡張コンプレックスシグネチャ用テストファイル。
/_testfiles/exe_standard_testfile.exe | phpMussel ＰＥシグネチャ用テストファイル。
/_testfiles/general_standard_testfile.txt | phpMussel一般シグネチャ用テストファイル。
/_testfiles/graphics_standard_testfile.gif | phpMusselグラフィックシグネチャ用テストファイル。
/_testfiles/html_standard_testfile.html | phpMussel正規化ＨＴＭＬシグネチャテストファイル。
/_testfiles/md5_testfile.txt | phpMussel ＭＤ５シグネチャ用テストファイル。
/_testfiles/ole_testfile.ole | phpMussel ＯＬＥシグネチャ用テストファイル。
/_testfiles/pdf_standard_testfile.pdf | phpMussel ＰＤＦシグネチャ用テストファイル。
/_testfiles/pe_sectional_testfile.exe | phpMussel ＰＥセクショナルシグネチャ用テストファイル。
/_testfiles/swf_standard_testfile.swf | phpMussel ＳＷＦシグネチャ用テストファイル。
/vault/ | ヴォルト・ディレクトリ（様々なファイルを含んでいます）。
/vault/cache/ | キャッシュ・ディレクトリ（一時データ用）。
/vault/cache/.htaccess | ハイパーテキスト・アクセスファイル（この場合、本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/fe_assets/ | フロントエンド資産。
/vault/fe_assets/.htaccess | ハイパーテキスト・アクセスファイル（この場合、本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/fe_assets/_accounts.html | フロントエンドのアカウント・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_accounts_row.html | フロントエンドのアカウント・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_config.html | フロントエンドのコンフィギュレーションページのＨＴＭＬテンプレート。
/vault/fe_assets/_config_row.html | フロントエンドのコンフィギュレーションページのＨＴＭＬテンプレート。
/vault/fe_assets/_files.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_edit.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_rename.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_row.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_home.html | フロントエンドのホームページのＨＴＭＬテンプレート。
/vault/fe_assets/_login.html | フロントエンドのログインページのＨＴＭＬテンプレート。
/vault/fe_assets/_logs.html | フロントエンドのロゴスページのＨＴＭＬテンプレート。
/vault/fe_assets/_nav_complete_access.html | フロントエンドのナビゲーションリンクのＨＴＭＬテンプレート、は完全なアクセスのためのものです。
/vault/fe_assets/_nav_logs_access_only.html | フロントエンドのナビゲーションリンクのＨＴＭＬテンプレート、はログのみにアクセスのためのものです。
/vault/fe_assets/_updates.html | フロントエンドのアップデート・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_updates_row.html | フロントエンドのアップデート・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_upload_test.html | アップロード・テスト・ページのＨＴＭＬテンプレート。
/vault/fe_assets/frontend.css | フロントエンドのＣＳＳスタイルシート。
/vault/fe_assets/frontend.dat | フロントエンドのデータベース（アカウント情報とセッション情報が含まれています； フロントエンドが有効になっているときに作成）。
/vault/fe_assets/frontend.html | フロントエンドのメインテンプレートファイル。
/vault/fe_assets/icons.php | アイコン・ハンドラ（フロント・エンド・ファイル・マネージャによって使用される）。
/vault/fe_assets/pips.php | ピップス・ハンドラ（フロント・エンド・ファイル・マネージャによって使用される）。
/vault/lang/ | phpMusselの言語データを含んでいます。
/vault/lang/.htaccess | ハイパーテキスト・アクセスファイル（この場合、本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/lang/lang.ar.fe.php | フロントエンドのアラビア語言語データ。
/vault/lang/lang.ar.php | アラビア語言語データ。
/vault/lang/lang.de.fe.php | フロントエンドのドイツ語言語データ。
/vault/lang/lang.de.php | ドイツ語言語データ。
/vault/lang/lang.en.fe.php | フロントエンドの英語言語データ。
/vault/lang/lang.en.php | 英語言語データ。
/vault/lang/lang.es.fe.php | フロントエンドのスペイン語言語データ。
/vault/lang/lang.es.php | スペイン語言語データ。
/vault/lang/lang.fr.fe.php | フロントエンドのフランス語言語データ。
/vault/lang/lang.fr.php | フランス語言語データ。
/vault/lang/lang.id.fe.php | フロントエンドのインドネシア語言語データ。
/vault/lang/lang.id.php | インドネシア語言語データ。
/vault/lang/lang.it.fe.php | フロントエンドの伊語言語データ。
/vault/lang/lang.it.php | 伊語言語データ。
/vault/lang/lang.ja.fe.php | フロントエンドの日本語言語データ。
/vault/lang/lang.ja.php | 日本語言語データ。
/vault/lang/lang.ko.fe.php | フロントエンドの韓国語言語データ。
/vault/lang/lang.ko.php | 韓国語言語データ。
/vault/lang/lang.nl.fe.php | フロントエンドのオランダ語言語データ。
/vault/lang/lang.nl.php | オランダ語言語データ。
/vault/lang/lang.pt.fe.php | フロントエンドのポルトガル語言語データ。
/vault/lang/lang.pt.php | ポルトガル語言語データ。
/vault/lang/lang.ru.fe.php | フロントエンドのロシア語言語データ。
/vault/lang/lang.ru.php | ロシア語言語データ。
/vault/lang/lang.th.fe.php | フロントエンドのタイ語言語データ。
/vault/lang/lang.th.php | タイ語言語データ。
/vault/lang/lang.ur.fe.php | フロントエンドのウルドゥー語言語データ。
/vault/lang/lang.ur.php | ウルドゥー語言語データ。
/vault/lang/lang.vi.fe.php | フロントエンドのベトナム語言語データ。
/vault/lang/lang.vi.php | ベトナム語言語データ。
/vault/lang/lang.zh-tw.fe.php | フロントエンドの繁体字中国語言語データ。
/vault/lang/lang.zh-tw.php | 繁体字中国語言語データ。
/vault/lang/lang.zh.fe.php | フロントエンドの簡体字中国語言語データ。
/vault/lang/lang.zh.php | 簡体字中国語言語データ。
/vault/quarantine/ | 検疫ディレクトリ（検疫されたファイル含んでいます）。
/vault/quarantine/.htaccess | ハイパーテキスト・アクセスファイル（この場合、本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/signatures/ | シグネチャディレクトリ（シグネチャファイルが含まれています）。
/vault/signatures/.htaccess | ハイパーテキスト・アクセスファイル（この場合、本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/signatures/switch.dat | 変数をコントロール、セットします。
/vault/.htaccess | ハイパーテキスト・アクセスファイル（この場合、本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/cli.php | CLIハンドラ。
/vault/components.dat | phpMusselのコンポーネント情報が含まれています； アップデート機能で使用（フロントエンドが提供します）。
/vault/config.ini.RenameMe | phpMussel設定ファイル； phpMusselの全オプション設定を記載しています。 それぞれのオプションの機能と動作手法の説明です（アクティブにするために名前を変更します）。
/vault/config.php | コンフィギュレーション・ハンドラ。
/vault/config.yaml | 設定・デフォルトス・ファイル；phpMusselのデフォルト設定値が含まれます。
/vault/frontend.php | フロントエンド・ハンドラ。
/vault/functions.php | 関数ファイル（本質的ファイル）。
/vault/greylist.csv | グレーリスト化されたシグネチャのＣＳＶで、phpMusselがどのシグネチャを無視すべきかを指示するものです（削除しても自動的に再作成されます）。
/vault/lang.php | 言語・ハンドラ。
/vault/php5.4.x.php | PHP 5.4.X ポリフィル （PHP 5.4.X の下位互換性のために必要です； より新しいPHPバージョンのために、削除しても安全です）。
※ /vault/scan_kills.txt | phpMusselによりブロック/削除されたアップロードファイルの全記録。
※ /vault/scan_log.txt | phpMusselによりスキャンされたものの全記録。
※ /vault/scan_log_serialized.txt | phpMusselによりスキャンされたものの全記録。
/vault/template_custom.html | phpMusselテンプレートファイル；phpMusselがファイルアップロードをブロックした際に作成されるメッセージのHTML出力用テンプレート（アップローダーが表示するメッセージ）。
/vault/template_default.html | phpMusselテンプレートファイル；phpMusselがファイルアップロードをブロックした際に作成されるメッセージのHTML出力用テンプレート（アップローダーが表示するメッセージ）。
/vault/themes.dat | テーマ・ファイル。 アップデート機能で使用（フロントエンドが提供します）。
/vault/upload.php | アップロード・ハンドラ。
/.gitattributes | GitHubのプロジェクトファイル（機能には関係のないファイルです）。
/Changelog-v1.txt | バージョンによる違いを記録したものです（機能には関係のないファイルです）。
/composer.json | Composer/Packagist情報（機能には関係のないファイルです）。
/CONTRIBUTING.md | プロジェクトに貢献する方法について。
/LICENSE.txt | GNU/GPLv2のライセンスのコピー（機能には関係のないファイルです）。
/loader.php | ローダー・ファイルです。主要スクリプトのロード、アップロード等を行います。フックするのはまさにこれです（本質的ファイル）！
/PEOPLE.md | プロジェクトに関わる人々についての情報。
/README.md | プロジェクト概要情報。
/web.config | ASP.NET設定ファイルです（スクリプトがASP.NETテクノロジーを基礎とするサーバーにインストールされた時に`/vault`ディレクトリを権限のないソースによるアクセスから保護するためです）。

※ ファイル名は設定の仕方（`config.ini`内）により異なることがあります。

---


### 7. <a name="SECTION7"></a>設定オプション
以下は`config.ini`設定ファイルにある変数ならびにその目的と機能のリストです。

#### "general" （全般、カテゴリー）
全般的な設定。

"cleanup" （クリーンアップ）
- 初回アップロード後に変数とキャッシュの設定をクリアするか否かについてのスクリプトです。 `false`(偽） = いいえ； `true`（真） = はい 「Default/デフォルト設定」。 初回アップロードスキャニング以外で使用することがなければ、`true`（真）としメモリーの使用量を最小にします。 使用するのであれば、`false`（偽）とし、メモリーに不要な重複データを再ロードするのを防ぎます。 通常は`true`（真）。 に設定しますが、初回アップロードスキャニングに対してしか使用できないことを覚えておいて下さい。
- CLIモードでは影響しません。

"scan_log" （スキャンログ）
- 全スキャニング結果を記録するファイルのファイル名。 ファイル名指定するか、無効にしたい場合は空白のままにして下さい。

"scan_log_serialized" （スキャンログシリアライズド）
- 全スキャニング結果を記録するファイルのファイル名（シリアル化形式を利用）。 ファイル名指定するか、無効にしたい場合は空白のままにして下さい。

"scan_kills" （スキャンキルズ）
- ブロックしたか削除したアップロードの全てを記録するファイのファイル名。 ファイル名指定するか、無効にしたい場合は空白のままにして下さい。

*有用な先端： あなたがしたい場合は、ログファイルの名前に日付/時刻情報を付加することができます、名前にこれらを含めることで:完全な年のため`{yyyy}`、省略された年のため`{yy}`、月`{mm}`、日`{dd}`、時間`{hh}`。*

*例：*
- *`scan_log='scan_log.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_log_serialized='scan_log_serialized.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_kills='scan_kills.{yyyy}-{mm}-{dd}-{hh}.txt'`*

"truncate" （トランケート）
- ログファイルが一定のサイズに達したら切り詰めますか？ 値は、ログファイルが切り捨てられる前に大きくなる可能性があるＢ/ＫＢ/ＭＢ/ＧＢ/ＴＢ単位の最大サイズです。 デフォルト値の０ＫＢは切り捨てを無効にします （ログファイルは無期限に拡張できます）。 注：個々のログファイルに適用されます。 ログファイルのサイズは一括して考慮されません。

"timeOffset" （タイム・オフセット）
- お使いのサーバの時刻は、ローカル時刻と一致しない場合、あなたのニーズに応じて、時間を調整するために、あなたはここにオフセットを指定することができます。 しかし、その代わりに、一般的にタイムゾーンディレクティブ（あなたの`php.ini`ファイルで）を調整ーることをお勧めします、でも時々（といった、限ら共有ホスティングプロバイダでの作業時）これは何をすることは必ずしも可能ではありません、したがって、このオプションは、ここで提供されています。 オフセット分であります。
- 例（１時間を追加します）：`timeOffset=60`

"timeFormat"
- phpMusselで使用される日付表記形式。 Default（デフォルト設定） = `{Day}, {dd} {Mon} {yyyy} {hh}:{ii}:{ss} {tz}`.

"ipaddr" （アイピーアドレス）
- 接続要求のＩＰアドレスをどこで見つけるべきかについて（Cloudflareのようなサービスに対して有効）。 Default（デフォルト設定） = REMOTE_ADDR。 注意： あなたが何をしているのか、分からない限り、これを変更しないでください。

"enable_plugins" （イネーブル・プラグインす）
- プラグインのサポートを有効にしますか？ `false` = いいえ； `true` = はい 「Default/デフォルト設定」。

"forbid_on_block" （フォービッド・オン・ブロック）
- アップロードファイルがブロックされたメッセージと共に、phpMusselから４０３ヘッダーを送るべきか、通常の２００でよいかどうかについて。 `false`（偽） = いいえ（２００） 「Default/デフォルト設定」； `true`（真） = はい（４０３）。

"delete_on_sight" （デリート・オン・サイト）
- このディレクティブを有効にすると、検知基準（シグネチャでも何でも）にあったアップロードファイルは直ちに削除されます。 クリーンと判断されたファイルはそのままです。 アーカイブの場合、問題のファイルが一部であってもアーカイブ全てが削除の対象となります。 アップロードファイルのスキャンにおいては、本ディレクティブを有効にすることは必須ではありません。 なぜならＰＨＰはスクリプト実行後に自動的にキャッシュの内容を破棄するからです。 言い換えれば、ファイルが移動されたか、コピーされたか、削除されない限り、ＰＨＰはサーバーにアップロードしたファイルを残しておくことは通常ありません。 このディレクティブはセキュリティーに念を入れる目的で設置されています。 ＰＨＰは稀に予測外の振る舞いをすることがあるからです。 `false`（偽） = スキャニング後、ファイルはそのまま（デフォルト設定）。 `true`（真） = スキャニング後、クリーンでなければ直ちに削除。

"lang" （ラング）
- phpMusselのデフォルト言語を設定します。

"quarantine_key" （クオランティン・キ―）
- phpMusselは、必要とあれば、phpMusselのヴォルト内で独立してフラグ付ファイルのアップロードを検疫することができます。 一般的なphpMusselのユーザーは、ウェブサイトやホスティング環境の保護ができれば充分と考えており、フラグ付のようなものにさらなる分析を加えようまでの要求はないようですので、無効で構いません。 ですが詳細に分析してマルウェアに備えたいユーザーは有効にすると良いでしょう。 フラグ付ファイルのアップロードの検疫は誤検出のデバッグに役立つことがあります。 検疫機能を無効にするには、`quarantine_key`ディレクティブを空にしておくか、空でない場合はディレクティブ内のコンテンツを消去して下さい。 有効にするには、デイレクティブに何らかの値を入れて下さい。 `quarantine_key`は検疫機能における重要なセキュリティー要素であり、検疫機能内に保存されたデータの執行を各種の攻撃から守っています。 `quarantine_key`はパスワードと同様に考えて下さい。 長い方がより安全と言えます。 最も効果的な使用法は`delete_on_sight`との併用です。

"quarantine_max_filesize" （クオランティン・マックス・ファイルサイズ）
- 検疫されるファイルサイズの上限。 この値より大きなファイルは検疫されません。 クオランティンの容量を超える異常に大きなファイルサイズによる攻撃で、メモリーが無駄に消費されるのを防ぐ意味で重要です。 デフォルト設定は２ＭＢです。

"quarantine_max_usage" （クオランティン・マックス・ユーセッジ）
- 検疫のために利用する最大メモリー量。 全メモリー量が使用されると、この範囲内に収まるよう古いファイルが削除の対象となります。 クオランティンの容量を超える異常に大きなファイルサイズによる攻撃で、メモリーが無駄に消費されるのを防ぐ意味で重要です。 デフォルト設定は６４ＭＢです。

"honeypot_mode" （ハニーポット・モード）
- ハニーポットモードが有効になっていると、phpMusselはアップロードされてきた全てのファイルを例外なく検疫します。 シグネチャにマッチするかどうかは問題としません。 スキャニングや分析もなされません。 phpMusselをウィルス/マルウェアのリサーチに利用と考えているユーザーにとって有益と言えるでしょう。 ただし、アップロードファイルのスキャニングという点からは、あまり推奨できませんし、ハニーポット・モードを本来の目的以外に使用することもお勧めできません。 デフォルト設定では無効です。 `false`（偽） = Disabled/無効 （Default/デフォルト）； `true`（真） = Enabled/有効。

"scan_cache_expiry" （スキャン・キャッシュ・エクスパイヤリー）
- phpMusselはスキャニング結果をどれくらいの期間キャッシュすべきか？ 秒単位で、デフォルトは２１，６００秒（６時間）となっています。 ０にするとキャッシュ無効になります。

"disable_cli" （ディスエイブル・シーエルアイ）
- ＣＬＩモードを無効にするか？ ＣＬＩモード（シーエルアイ・モード）はデフォルトでは有効になっていますが、テストツール（PHPUnit等）やＣＬＩベースのアプリケーションと干渉しあう可能性が無いとは言い切れません。 ＣＬＩモードを無効にする必要がなければ、このデレクティブは無視してもらって結構です。 `false`（偽） = ＣＬＩモードを有効にします（Default/デフォルルト）； `true`（真） = ＣＬＩモードを無効にします。

"disable_frontend" （ディスエイブル・フロントエンド）
- フロントエンドへのアクセスを無効にするか？ フロントエンドへのアクセスは、phpMusselをより管理しやすくすることができます。 前記、それはまた、潜在的なセキュリティリスクになる可能性があります。 バックエンドを経由して管理することをお勧めします、しかし、これが不可能な場合、フロントエンドへのアクセスが提供され。 あなたがそれを必要としない限り、それを無効にします。 `false`（偽） = フロントエンドへのアクセスを有効にします； `true`（真） = フロントエンドへのアクセスを無効にします（Default/デフォルルト）。

"max_login_attempts" （マクス・ログイン・アテンプト）
- ログイン試行の最大回数（フロントエンド）。 Default（デフォルト設定） = ５。

"FrontEndLog" （フロントエンド・ログ）
- フロントエンド・ログインの試みを記録するためのファイル。 ファイル名指定するか、無効にしたい場合は空白のままにして下さい。

"disable_webfonts" （ディスエイブル・ウェブフォンツ）
- ウェブフォンツを無効にしますか？ True = はい； False = いいえ （Default/デフォルルト）。

#### "signatures" （シグネチャーズ、カテゴリ）
シグネチャの設定。

"Active" （アクティブ）
- カンマで区切られたアクティブなシグネチャファイルのリスト。

"fail_silently" （フェイル・サイレントリー）
- シグネチャファイルがない、あるいは破損している場合に、phpMusselがそれをリポートすべきか否か？ `fail_silently`が無効ならば、問題はリポートされ、有効であれば、問題は無視されたスキャニングレポートが作成されます。 クラッシュするというような害がなければ、デフォルト設定のままにしておくべきです。 `false`（偽） = Disabled/無効; `true`（真） = Enabled/有効 （Default/デフォルト）。

"fail_extensions_silently" （フェイル・エクステンションズ・サイレントリー）
- 拡張子がない場合にphpMusselがそれをレポートすべきか否か？ `fail_extensions_silently`が無効の場合、拡張子なしはスキャニング時にレポートされ、有効の場合は無視され問題は報告されません。 このディレクティブを無効にすることは、セキュリティーを向上させるかもしれませんが、誤検出も増加する恐れがあります。 `false`（偽） = Disabled/無効; `true`（真） = Enabled/有効 （Default/デフォルト）。

"detect_adware" （ディテクト・アドウェア）
- phpMusselはアドウェア検出のためにシグネチャを分析すべきか否か？ `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

"detect_joke_hoax" （ディテクト・ジョーク・ホークス）
- phpMusselは悪戯/偽造やマルウェア/ウィルス検出のためにシグネチャを分析すべきか否か？ `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

"detect_pua_pup" （ディテクト・PUA・PUP）
- phpMusselはPUAs/PUPs検出のためにシグネチャを分析すべきか否か？ `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

"detect_packer_packed" （ディテクト・パッカー・パックト）
- phpMusselはパッカーやパックデータ検出のためにシグネチャを分析すべきか否か？ `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

"detect_shell" （ディテクト・シェル）
- phpMusselはshellスクリプト検出のためにシグネチャを分析すべきか否か？ `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

"detect_deface" （ディテクト・ディフェーサ）
- phpMusselは改ざんやディフェーサー検出のためにシグネチャを分析すべきか否か？ `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

#### "files" （ファイルズ、カテゴリー）
ファイル取扱い設定。

"max_uploads" （マックス・アップローズ）
- 一度にスキャンできるアップロードファイル数の上限で、これを超えるとスキャンを中断し、ユーザーにその旨を知らせ、論理攻撃からの保護として機能します。 システムやCMSがDDoS攻撃にあい、phpMusselがオーバーロードしてＰＨＰプロセスに支障をきたすことがないようにするためです。 推奨数は１０ですが、ハードウェアのスピードによっては、これ以上/以下がよいということもあるでしょう。この数は、アーカイブのコンテンツは含まないことを覚えておいて下さい。

"filesize_limit" （ファイルサイズ・リミット）
- ファイルサイズ上限の単位はKBです。 65536 = 64MB （Default/デフォルト）； 0 = リミットしません（上限なし、常にグレイリスト化）、正の数値であれば何でも構いません。 ＰＨＰの設定でメモリーに制限があったり、アップロードファイルサイズの上限が設定されている場合に有効的です。

"filesize_response" （ファイルサイズ・レスポンス）
- 上限サイズを超えるファイルをどう処理するかについてです。 `false`（偽） = Whitelist（ホワイトリスト）; `true`（真） = Blacklist（ブラックリスト） （Default/デフォルト）。

"filetype_whitelist" （ファイルタイプ・ホワイトリスト）、 "filetype_blacklist" （ファイルタイプ・ブラックリスト）、 "filetype_greylist" （ファイルタイプ・グレーリスト）
- システムが特定タイプのファイルのみアップロードを許可する、あるいは拒絶する場合は、ファイルタイプを適切にホワイトリスト、ブラックリスト、グレーリストにて分類しておくと、ファイルタイプによって弾かれるファイルはスキャンをスキップできるため、スピードアップに繋がります。 フォーマットはＣＳＶ（カンマ区切り）です。 リストによらず全てをスキャンしたい場合は、変数は空白のままとし、ホワイトリスト/ブラックリスト/グレーリストを無効にします。
- プロセスの論理的順序:
 - ファイルタイプがホワイトリストに記載されていれば、スキャンせず、ブロックせず、ブラックリストおよびグレイリストに対してチェックを行いません。
 - ファイルタイプがブラックリストに記載されていれば、スキャンすることなく、直ちににブロックし、グレーリストに対してチェックを行いません。
 - グレーリストが空、あるいはグレーリストが空でなくかつそのファイルタイプがあれば、通常通りスキャンしブロックするか否かを判断します。 グレーリストが空でなくかつそのファイルタイプが含まれていなければ、ブラックリストと同様の扱いをすることになり、スキャンなしにブロックします。

"check_archives" （チェック・アーカイブズ）
- アーカイブのコンテンツに対してチェックを試みるか否かについてです。 `false`（偽） = チェックしない; `true`（真） = チェックする（Default/デフォルト）。
- 現在サポートしているのはBZ、GZ、 LZF、 ZIP形式です（RAR、CAB、7z等は対象外）。
- 本機能は万能ではありませんので、有効にしておくことを推奨していますが、必ず全てを検出することを保証するものではありません。
- また現在チェックのアーカイブはZIPに対して再帰的でないことに注意して下さい。

"filesize_archives" （ファイルサイズ・アーカイブズ）
- ファイルサイズのブラックリスト化/ホワイトリスト化をアーカイブのコンテンツに持ち込むか否か？ `false` = いいえ（ただグレーリストすべて）; `true` = はい 「Default/デフォルト設定」。

"filetype_archives" （ファイルタイプ・アーカイブズ）
- ファイルタイプのブラックリスト化/ホワイトリスト化をアーカイブのコンテンツに持ち込むか否か？ `false` = いいえ（ただグレーリストすべて） 「Default/デフォルト設定」; `true` = はい。

"max_recursion" （マックス・リカーション）
- アーカイブに対する最大再帰深さです。 デフォルト＝１０。

"block_encrypted_archives" （ブロック・エンクリプティッド・アーカイブズ）
- 暗号化されたアーカイブを検出しブロックするか否か？ phpMusselは暗号化されたアーカイブをスキャンすることはできないので、アーカイブの暗号化によってphpMussel、アンチウィルススキャナー等をかいくぐろうとする攻撃者がいるかもしれません。 暗号化されたアーカイブをブロックすることにより、このようなリスクを回避することができます。 `false`（偽） = いいえ； `true`（真） = はい （Default/デフォルト）。

#### "attack_specific" （アタック・スペシフィック、カテゴリー）
アタックースペシフィック　ディレクティブ。

キャメロンアタック検出。 `false`（偽） = オフ; `true`（真） = オン。

"chameleon_from_php" （キャメロン・フロム・ピーエイチピー）
- ファイルでもなくPHPアーカイブとも認識できないファイル中のPHPヘッダーを探します。

"chameleon_from_exe" （キャメロン・フロム・エグゼ）
- 実行ファイルでもなく実行ファイルのアーカイブとも認識できないファイル中の実行ヘッダーや不正なヘッダーの実行ファイルを探します。

"chameleon_to_archive" （キャメロン・トゥ・アーカイブ）
- ヘッダーが正しくないアーカイブを探します（BZ、GZ、RAR、ZIP、GZをサポート）。

"chameleon_to_doc" （キャメロン・トゥ・ドク）
- ヘッダーが正しくないオフィスドキュメントを探します（DOC、DOT、PPS、PPT、XLA、XLS、WIZをサポート）。

"chameleon_to_img" （キャメロン・トゥ・アイエムジー）
- ヘッダーが正しくない画像ファイルを探します（BMP、DIB、PNG、GIF、JPEG、JPG、XCF、PSD、PDD、WEBPをサポート）。

"chameleon_to_pdf" （キャメロン・トゥ・ピーディーエフ）
- ヘッダーが正しくないPDFファイルを探します。

"archive_file_extensions" （アーカイブ・ファイル・エクステンション）
- 認識可能なアーカイブファイルエクステンションです（フォーマットはＣＳＶ； 問題があった場合にのみ追加あるいは取り除くべきです。 不用意に取り除くと誤検出の原因となる可能性があります。 反対に不用意に追加すると、アタックースペシフィック検出から追加したものをホワイトリスト化してしまいます。 充分に注意に上、変更して下さい。 なお、コンテントレベルにおいてアーカイブを分析することが出来るか否かには影響しません）。 デフォルトでは最も一般なフォーマットをリストしていますが、意図的に包括的にはしていません。

"block_control_characters" （ブロック・コントロール・キャラクターズ）
- 制御文字を含んだファイルをブロックするか否か（改行以外）？ についてです（[\x00-\x08\x0b\x0c\x0e\x1f\x7f]）。 もし、テキストのみをアップロードするなら、このオプションを有効にして、さらにプロテクションを強化できます。 テキスト以外もアップロード対象であれば、有効にすると誤検出の原因になりえます。 `false`（偽） = ブロックしない（Default/デフォルト）； `true`（真） = ブロックする。

"corrupted_exe" （コラプティッド・エグゼ）
- 破損ファイルとエラー解析。`false`（偽） = 無視する； `true`（真） = ブロックする（Default/デフォルト）。 破損の可能性があるPEファイルをブロックし検出するか否か？ についてです。 ＰＥファイルの一部が破損し、正しく分析できないことは珍しくなく、ウィルス感染をみるバロメーターになります。 ＰＥファイル内のウィルスを検出するアンチウィルスプログラムは、ＰＥファイルの解析を行いますが、ウィルスを作る側では、ウィルスが検出されないようそれを避けようとするものだからです。

"decode_threshold" （デコード・スレッシュホールド）
- デコード・コマンドが検出されるべき生データの長さの制限（スキャニング中に顕著な問題がある場合に必要に応じて設定）。 デフォルト ＝ ５１２ＫＢ。 ゼロあるいは値なし（null）はしきい値を無効化します（ファイルサイズによる制限を取り除きます）。

"scannable_threshold" （スキャナブル・スレッシュホールド）
- phpMusselが読みスキャンしてよい生データの長さの制限（スキャニング中に顕著な問題がある場合に必要に応じて設定）。 デフォルト ＝ ３２ＭＢ。 ゼロあるいは値なし（null）はしきい値を無効化します。 値は、サーバーやウェブサイトでアップロードされるファイルの平均ファイルサイズより大きく、filesize_limitディレクティブより小さく設定すべきです。 また`php.ini`設定によってPHPに割り当てられたメモリーのおおよそ5分の１を超えるべきではありません。 このディレクティブはphpMusselがメモリーを使い過ぎないようにするためのものです。 （一定のサイズ以上のファイルはスキャンできなくなることもあります）。

#### "compatibility" （コンパーティブリティ、カテゴリ）
phpMusselの互換性ディレクティブ。

"ignore_upload_errors" （イグノア・アップロード・エラーズ）
- システム上でphpMusselの機能に修正が必要でない限りはこのディレクティブは通常無効です。 無効に設定すると、`$_FILES` array()に要素の存在を検知したとき、その要素が表すファイルのスキャンが開始され、要素が空白か無であればphpMusselはエラーメッセージを返します。 これは本来phpMusselがあるべき姿です。しかしCMSにおいては、$_FILESの空要素は普通に発生するものであり、正常なphpMusselの挙動が正常なCMSの挙動を阻害する恐れがあります。 このような場合は、本オプションを有効にして、phpMusselが空要素をスキャンしてエラーメッセージを返すのを避け、要求のあったページへスムーズに進むことができるようにします。 `false`（偽） = OFF （オフ）； `true`（真） = ON （オン）です。

"only_allow_images" （オンリー・アロウ・イメージ）
- システムあるいはCMSに画像ファイルのアップロードのみを許可するのであれば、このディレクティブは有効にすべきであり、そうでなければ無効とします。 有効にすると、画像と特定できないファイルはスキャンすることなしにブロックしますので、プロセス時間の短縮とメモリーの節約が期待できます。 `false`（偽） = OFF （オフ）； `true`（真） = ON （オン） です。

#### "heuristic" （ヒューリスティック、カテゴリ）
ヒューリスティック・ディレクティブズ。

"threshold" （スレッシュホールド）
- phpMusselには、このファイルは疑わしく危険性が高いと判断するシグネチャがあります。 しきい値は、アップロードされているファイルの危険性の最大値であり、これを超えるとマルウェアと判断されます。ここにおける危険性の定義とは、疑わしいと特定されたものの総数です。 デフォルトでは３に設定されています。 これより低いと誤検出の可能性が増え、大きすぎると、誤検出は減るものの危険性のあるファイルが検出されない可能性が増加してしまいます。 特に問題がなければ、デフォルト値のままにしておくことお勧めします。

#### "virustotal" （ウィルストータル、カテゴリ）
VirusTotal.comディレクティブズ。

"vt_public_api_key" （ヴィティ・パブリック・エイピーアイ・キー）
- オプションですが、phpMusselはVirus Total APIを使ってファイルをスキャンすることができます。 ウィルス、トロイの木馬、マルウェア、その他の攻撃に対して非常に効果的に機能します。 デフォルトではVirus Total APIを使ったスキャニングは無効になっています。 有効にするには、Virus TotalのAPIキーが必要です。 メリットが極めて大きいため、有効にすることを強く推奨します。 Virus Total APIの使用にあたっては、Virus Totalのドキュメンテーションにある通り、利用規定ならびにガイドラインを遵守しなくてはなりません。 この統合機能を使用するためには：
 - Virus TotalとAPIのサービス規定を読み同意すること。 [サービス規定はこちらから](https://www.virustotal.com/en/about/terms-of-service/)。
 - 最低でもVirus Total Public APIドキュメンテーションの前文を読み理解すること（VirusTotalPublic API v2.0以降Contents「コンテンツ」前まで）。 Virus Total Public APIの[ドキュメンテーションはこちらから](https://www.virustotal.com/en/documentation/public-api/)。

注意：Virus Total API使用したスキャニングが無効になっている場合、このカテゴリー（`virustotal`）のディレクティブを参照する必要はありません。無効であれば、どれも機能しません。Virus Total APIキーを取得するには、Virus Totalのサイトのページ右上にあるリンク「コミュニティに参加」をクリックして、必要事項を記入しサインアップします。インストラクションに従ってパブリックAPIキーを取得した後、`config.ini`設定ファイルの`vt_public_api_key`ディレクティブのそれをコピー＆ペーストして下さい。

"vt_suspicion_level" （ヴィティ・サスピション・レベル）
- デフォルト設定では、phpMusselがVirus Total APIを使ってスキャンするファイル（疑がわしいもの）には制限があります。 `vt_suspicion_level`ディレクティブを編集することのより、この制限を変更することが可能です。
- `0`： phpMusselのシグネチャを使ってスキャンした結果、ヒューリスティックな重みがあると判断された場合にのみ、疑わしいファイルと結論付けられます。 すなわちVirus Total APIは、phpMusselが危険性を察知はしたが完全にそうとは言い切れず、したがってブロックもせず、フラグを付けることもしなかった時のセカンドオピニオンです。
- `1`： phpMusselのシグネチャを使ってスキャンした結果、実行ファイルと思われる（PEファイル、Mach-O ファイル、ELF/Linuxファイル等）、ないしは実行可能なデータを含んだフォーマット（マクロ、DOC/DOCXファイル、アーカイブRAR/ZIPファイル等)があれば、ヒューリスティックな重みがあるとして疑わしいファイルと結論付けられます。これはデフォルト設定であり、推奨レベルでもあります。 Virus Total APIは、phpMusselが危険性なしと判断し、したがってブロックもせず、フラグを付けることもしなかった時のセカンドオピニオンです。
- `2`： ファイルは全て疑わしいものとされ、Virus Total APIを使ってスキャンされます。 API割り当てを使い切る恐れがあるため、推奨は控えますが、状況によっては適切と言えるでしょう（例えば、ウェブマスターやホストマスターがアップロードされる内容を信頼できない状況等）。 この警戒レベルでは、通常ブロック/フラグも対象にならないファイルも全てVirus Total APIを使ってスキャンされます。 したがって、Virus Total APIの割り当てを早々に消費してしまうこともあり得、またAPI割り当てを使い切れば、phpMusselはVirus Total APIの使用を中止します（警戒レベルに関係なく）。

注意： phpMusselによってブラックリスト化、ホワイトリスト化されたファイルはVirus Total APIを使ったスキャンの対象にはなりません。 これらは既に善悪が結論付けられたものであり、Virus Total APIで再びスキャンする必要性はないためです。 phpMusselが、Virus Total APIを利用するのは、phpMussel自身が危険性の有無について判断しかねる状況においての補助と言えます。

"vt_weighting" （ヴィティ・ウェイティング）
- phpMusselがVirus Total APIを使ったスキャニング結果を検出として扱うか、検出の重み付けとして扱うべきか？ 複数のエンジン（Virus Totalのように）を使用したスキャニングは、検出率の向上（より多くのマルウェアが検出）をもたらす一方で誤検出の増加も招くため、このディレクティブが存在します。 したがって、スキャニング結果は、決定的判断ではなく信頼スコアとして利用した方が適当なケースもあります。 値が０の場合、Virus Total APIを使ったスキャンは検出として扱われ、Virus Totalのエンジンがマルウェアとフラグを付けたファイルは、phpMusselもマルウェアと判断します。 その他の値の場合は結果は検出の重み付けとなり、スキャンされたファイルがマルウェアかどうかphpMusselが判断するための信頼スコア（あるいは検出の重み付け）となります（値はマルウェアと判断するための最小信頼スコア、あるいは重み）。 デフォルト値は０です。

"vt_quota_rate" （ヴィティ・クォータ・レート） と "vt_quota_time" （ヴィティ・クォータ・タイム）
- Virus Total APIのドキュメンテーションによると「１分間のタイムフレームの間にリクエストは最大４回」の上限があります。 ハニークライアントやハニーポット等のオートメーションを使用し、リポートを受け取るだけでなく、VirusTotal にリソースを提供していれば、上限は引き上げられます。 phpMussel のデフォルトでは最大４回を遵守していますが、前述の事情から、この２つのディレクトリを準備し、状況に合わせて変更できるようになっています。 制限に達してしまうといった不都合や問題がない限りデフォルト値を変更することは勧められませんが、値を小さくすることが適当なケースもあります。 上限はタイムフレーム`vt_quota_time`（ヴィティ・クォータ・タイム）「分内に」`vt_quota_rate`（ヴィティ・クォータ・レート）で設定します。

#### "urlscanner" （ユーアールエルスキャナー、カテゴリ）
phpMusselにはURLスキャナーがビルトインされていて、スキャンされたファイルやデータ内の悪質なURLを検出することができます。

注意： URLスキャナーが無効の場合、このカテゴリー（`urlscanner`）を参照する必要はありません。

URLスキャナーAPIルックアップ設定。

"lookup_hphosts" （ルックアップ・エイチピーホスツ）
- Trueにすると、APIの[hpHosts](http://hosts-file.net/)ルックアップが有効になります。 hpHostsはAPIルックアップを実行するのに API鍵を必要としません。

"google_api_key" （グーグル・エーピーアイ・キー）
- 必要なAPI鍵が定義されれば、APIのGoogle Safe Browsing APIルックアップが有効になります。 Google Safe Browsing APIルックアップスに必要なAPI鍵は、[から取得することができます](https://console.developers.google.com/)。
- 注意：Google Safe Browsing APIルックアップはまだ完成していないので、将来的な利用を想定しています。

"maximum_api_lookups" （マクシマム・エーピーアイ・ルックアップス）
- スキャン反復におけるAPIルックアップの最大回数。APIルックアップの度にスキャン反復の時間が積み重なってしまうので、スキャン処理の速度向上のため、制限を設けたいと考えるかもしれません。 ０は制限なしを意味します。 デフォルトは１０です。

"maximum_api_lookups_response" （マクシマム・エーピーアイ・ルックアップス・レスポンス）
- APIルックアップの回数制限を超えた時の対応です。 `false`（偽） = 何もしない/処理を継続する （Default/デフォルト）； `true`（真） = ファイルにフラグを付ける/ブロックする。

"cache_time" （キャッシュ・タイム）
- APIルックアップの結果をどれくらいキャッシュするか（秒単位です）？ デフォルトは３６００秒（一時間）。

#### "template_data" （テンプレート・データ、カテゴリ）
テンプレートとテーマ用のディレクティブ/変数。

テンプレートのデータは、ユーザーに向けてアップロード拒否のメッセージをＨＴＭＬ形式でアウトプットする際に使用されます。カスタムテーマを使っている場合は`template_custom.html`を使用して、そうでない場合は`template.html`を使用してＨＴＭＬアウトプットが生成されます。設定ファイル内にあるこのセクション用の変数は、ＨＴＭＬアウトプットのために解析され、で囲まれた変数名は対応する変数データに置き換えられます。例えば`foo="bar"`とすると、ＨＴＭＬアウトプット内の`<p>{foo}</p>`は`<p>bar</p>`となります。

"theme" （シーム/テーマ）
- phpMusselに使用するデフォルトテーマ。

"css_url" （シーエスエス・ユーアールエル）
- カスタムテーマ用のテンプレートファイルは、外部ＣＳＳプロパティーを使っています。 一方、デフォルトテーマは内部ＣＳＳです。 カスタムテーマを適用するためには、ＣＳＳファイルのパブリック ＨＴＴＰアドレスを"css_url"変数を使って指定して下さい。 この変数が空白であれば、デフォルトテーマが適用されます。

---


### 8. <a name="SECTION8"></a>シグネチャ（署名）フォーマット

#### *ファイル名シグネチャ*
ファイル名シグネチャのフォーマットは例外なく次のようになります。

`NAME:FNRX`

NAMEはそのシグネチャを指す名前でFNRXはファイル名（エンコードされていない）にマッチする正規表現パターンです。

#### *ＭＤ５シグネチャ*
ＭＤ５シグネチャのフォーマットは例外なく次のようになります。

`HASH:FILESIZE:NAME`

HASHは全ファイルのMD5 ハッシュ、FILESIZEはファイルの全サイズ、NAMEはそのシグネチャを指す名前です。

#### *PEセクショナルシグネチャ*
PEセクショナルシグネチャのフォーマットは例外なく次のようになります。

`SIZE:HASH:NAME`

HASHはPEファイルのある部分のMD5ハッシュ、SIZEはその部分の全サイズ、NAMEはシグネチャを指す名前です。

#### *ＰＥ拡張シグネチャ*
ＰＥ拡張シグネチャのフォーマットは例外なく次のようになります。

`$VAR:HASH:SIZE:NAME`

$VARはマッチするＰＥ変数の名前、HASHはその変数のMD5ハッシュ、サイズは変数の全サイズ、NAMEはそのシグネチャを指す名前です。

#### *ホワイトリストシグネチャ*
ホワイトリストシグネチャのフォーマットは例外なく次のようになります。

`HASH:FILESIZE:TYPE`

HASHは全ファイルのMD5ハッシュ、FILESIZEはそのファイルの全サイズ、TYPEはホワイトリスト化されたファイルが攻撃を受ける恐れのないのシグネチャタイプです。

#### *複合拡張シグネチャ*
複合拡張シグネチャは他のシグネチャとは少し違い、何に適合するかはそれ自身のシグネチャによって決まり、基準は一つではありません。適合基準は「;」により、適合タイプ、適合データは「:」によります。したがってフォーマットは、$変数１:何らかのデータ;$変数２:SOMEDATA;何らかのデータのようになります。

`$variable1:SOMEDATA;$variable2:SOMEDATA;SignatureName`

#### *その他*
その他のシグネチャのフォーマットです。

`NAME:HEX:FROM:TO`

NAMEはそのシグネチャを指す名前、HEXは与えられたシグネチャにより適合を見るファイルの１６進法にエンコードされたセグメントです。 FROMとTOはオプション・パラメータで、データソースのどこからどこまでチェックするかを示します（メール機能ではサポートしていません）。

#### *正規表現*
PHPが正規表現と判断し処理するフォーマットであれば、phpMusselとシグネチャによって間違いなく処理されます。 しかし念のため、シグネチャを基礎とする正規表現を新規に作成する場合は細心の注意を払って下さい。 絶対的な自信がない状況では、思いもしないエラーが発生しかねません。 正規表現ステートメントが解析されているコンテキストを完全に理解していないならば、phpMusselのコードを見て下さい。 パターンは全て（ファイル名、アーカイブ・メタデータ、ＭＤ５パターンを除く）１６進法でエンコードされなければならない点に注意(上記のパターン構文も)です！

---


### 9. <a name="SECTION9"></a>適合性問題

#### PHPとPCRE
- phpMusselが正しく動作するためにはPHPとPCREが必要です。どちらか一方でも欠けると正常に機能しません。システムにPHPとPCREの両方がインストールされていることをphpMusselダウンロード前に確認して下さい。

#### アンチウィルスソフトウェアとの互換性

phpMusselは大概のウィルススキャンソフトウェアに対して互換性があります。しかし、過去にはユーザーから非互換性の報告があったのも確かです。以下の情報はVirusTotal.comによるものであり、phpMusselに対しアンチウィルスプログラムによって報告された誤検出を記載しています。phpMusselと使用中のアンチウィルスソフトウェアの互換性問題が記載通りに必ず発生する、あるいは発生しないことを保証するものではありませんが、もしアンチウィルスソフトウェアとphpMusselの動作に顕著な矛盾が認められるようなら、使用にあたってどちらか一方を無効にするなどの対策を検討すべきでしょう。

以下の情報は、2016年8月29日にアップデートされ、本稿執筆時におけるphpMussel最新マイナーバージョン（v0.10.0-v1.0.0）の現況です。

| スキャナ | 結果 |
|----------------------|--------------------------------------|
| Ad-Aware | 問題は報告されていません |
| AegisLab | 問題は報告されていません |
| Agnitum | 問題は報告されていません |
| AhnLab-V3 | 問題は報告されていません |
| Alibaba | 問題は報告されていません |
| ALYac | 問題は報告されていません |
| AntiVir | 問題は報告されていません |
| Antiy-AVL | 問題は報告されていません |
| Arcabit | 問題は報告されていません |
| Avast | リポート "JS:ScriptSH-inf [Trj]" |
| AVG | 問題は報告されていません |
| Avira | 問題は報告されていません |
| AVware | 問題は報告されていません |
| Baidu | リポート "VBS.Trojan.VBSWG.a" |
| Baidu-International | 問題は報告されていません |
| BitDefender | 問題は報告されていません |
| Bkav | リポート "VEXC640.Webshell"、 "VEXD737.Webshell"、 "VEX5824.Webshell"、 "VEXEFFC.Webshell"|
| ByteHero | 問題は報告されていません |
| CAT-QuickHeal | 問題は報告されていません |
| ClamAV | 問題は報告されていません |
| CMC | 問題は報告されていません |
| Commtouch | 問題は報告されていません |
| Comodo | 問題は報告されていません |
| Cyren | 問題は報告されていません |
| DrWeb | 問題は報告されていません |
| Emsisoft | 問題は報告されていません |
| ESET-NOD32 | 問題は報告されていません |
| F-Prot | 問題は報告されていません |
| F-Secure | 問題は報告されていません |
| Fortinet | 問題は報告されていません |
| GData | 問題は報告されていません |
| Ikarus | 問題は報告されていません |
| Jiangmin | 問題は報告されていません |
| K7AntiVirus | 問題は報告されていません |
| K7GW | 問題は報告されていません |
| Kaspersky | 問題は報告されていません |
| Kingsoft | 問題は報告されていません |
| Malwarebytes | 問題は報告されていません |
| McAfee | リポート "New Script.c" |
| McAfee-GW-Edition | リポート "New Script.c" |
| Microsoft | 問題は報告されていません |
| MicroWorld-eScan | 問題は報告されていません |
| NANO-Antivirus | 問題は報告されていません |
| Norman | 問題は報告されていません |
| nProtect | 問題は報告されていません |
| Panda | 問題は報告されていません |
| Qihoo-360 | 問題は報告されていません |
| Rising | 問題は報告されていません |
| Sophos | 問題は報告されていません |
| SUPERAntiSpyware | 問題は報告されていません |
| Symantec | 問題は報告されていません |
| Tencent | 問題は報告されていません |
| TheHacker | 問題は報告されていません |
| TotalDefense | 問題は報告されていません |
| TrendMicro | 問題は報告されていません |
| TrendMicro-HouseCall | 問題は報告されていません |
| VBA32 | 問題は報告されていません |
| VIPRE | 問題は報告されていません |
| ViRobot | 問題は報告されていません |
| Zillya | 問題は報告されていません |
| Zoner | 問題は報告されていません |

---


### 10. <a name="SECTION10"></a>よくある質問（FAQ）

#### 「シグネチャ」とは何ですか？

In the context of phpMussel, a "signature" refers to data that acts as an indicator/identifier for something specific that we're looking for, usually in the form of some very small, distinct, innocuous segment of something larger and otherwise harmful, like a virus or trojan, or in the form of a file checksum, hash, or other similarly identifying indicator, and usually includes a label, and some other data to help provide additional context that can be used by phpMussel to determine the best way to proceed when it encounters what we're looking for.

#### 「偽陽性」とは何ですか？

一般化された文脈で簡単に説明、条件の状態をテストするときに、結果を参照する目的で、用語「偽陽性」（*または：偽陽性のエラー、虚報；* 英語： *false positive*; *false positive error*; *false alarm*）の意味は、結果は「陽性」のようです、しかし結果は間違いです（即ち、真の条件は「陽性/真」とみなされます、しかしそれは本当に「陰性/偽」です）。 「偽陽性」は「泣く狼」に類似していると考えることができます（その状態は群の近くに狼がいるかどうかである、真の条件は「偽/陰性」です、群れの近くに狼がないからです、しかし条件は「真/陽性」として報告されます、羊飼いが「狼！狼！」を叫んだからです）、または、医療検査に類似、患者が誤って診断されたとき。

いくつかの関連する用語は、「真陽性」、「真陰性」、と「偽陰性」です。 これらの用語が示す意味： 「真陽性」の意味は、テスト結果と真の条件が真です（即ち、「陽性」です）。 「真陰性」の意味は、テスト結果と真の条件が偽です（即ち、「陰性」です）。 「真陽性」と「真陰性」は「正しい推論」とみなされます。 「偽陽性」の反対は「偽陰性」です。 「偽陰性」の意味は、テスト結果が偽です（即ち、「陰性」です）、しかし、真の条件が本当に真です（即ち、「陽性」です）； 両方テスト結果と真の条件、が「真/陽性」すべきであるはずです。

phpMusselの文脈で、これらの用語は、phpMusselのシグネチャとそれらがブロックするファイルを指します。 phpMusselが誤ってファイルをブロックすると（例えば、不正確なシグネチャ、時代遅れのシグネチャなどによる）、我々はこのイベント「偽陽性」のを呼び出します。 phpMusselがファイルをブロックできなかった場合（例えば、予期せぬ脅威、シグネチャの欠落などによる）、我々はこのイベント「不在検出」のを呼び出します（「偽陰性」のアナログです）。

これは、以下の表に要約することができます。

&nbsp; | phpMusselは、ファイルをブロック必要がありません | phpMusselは、ファイルをブロック必要があります
---|---|---
phpMusselは、ファイルをブロックしません | 真陰性（正しい推論） | 不在検出（それは「偽陰性」と同じです）
phpMusselは、ファイルをブロックします | __偽陽性__ | 真陽性（正しい推論）

#### シグネチャはどれくらいの頻度でアップデイトされますか？

アップデイト頻度は、シグネチャファイルによって異なります。 phpMusselのシグネチャファイルのすべてのメンテナーが頻繁にアップデイトを試みる、しかし、私たちの皆様には、他にもさまざまなコミットメントがあり、私たちはプロジェクトの外で生活しており、と誰も財政的に補償されていない、したがって、正確なアップデイトスケジュールは保証されません。 一般に、十分な時間があればシグネチャがアップデイトされます。 メンテナーは必要性と範囲間の変化の頻度に基づいて優先順位をつけようとする。 あなたが何かを提供できるのであれば、援助は常に高く評価されます。

#### phpMusselを使用しているときに問題が発生しましたが、何をすべきかわかりません！ 助けてください！

- あなたは最新のソフトウェアバージョンを使用していますか？ あなたは最新のシグネチャファイルバージョンを使用していますか？ そうでない場合は、まずすべてをアップデイトしてください。 問題が解決しないかどうかをチェックしてください。 それが続く場合は、読んでください。
- あなたはドキュメンテーションをチェックしましたか？ もしそうでなければ、そうしてください。 ドキュメンテーションを使用して問題を解決できない場合は、引き続き読んでください。
- **[イシュー・ページ](https://github.com/Maikuolan/phpMussel/issues)** をチェックしましたか？ 問題が以前に言及されているかどうかをチェックしてください。 提案、アイデア、ソリューションが提供されたかどうかをチェックしてください。
- **[Spambot Securityが提供するphpMusselサポート・フォーラム](http://www.spambotsecurity.com/forum/viewforum.php?f=55)** をチェックしましたか？ 問題が以前に言及されているかどうかをチェックしてください。 提案、アイデア、ソリューションが提供されたかどうかをチェックしてください。
- 問題が解決しない場合は、教えてください。 イシュー・ページまたはサポート・フォーラムに関する新しいディスカッションを作成する。

#### 5.4.0より古いPHPバージョンでphpMusselを使用したいと思います； 手伝ってくれますか？

いいえ。 PHP 5.4.0は2014年に公式EoL（「End of Life」/人生の終わり）に達しました。 長期的なセキュリティサポートは2015年に終了しました。 現在、それは2017であり、PHP 7.1.0はすでに利用可能です。 現在、PHP 5.4.0およびすべてのより新しいPHPバージョンでphpMusselを使用するためのサポートが提供されています。 より古いPHPバージョンのサポートは提供されていません。

#### 複数のドメインを保護するために１つのphpMusselインストールを使用できますか？

はい。 phpMusselのインストールは特定のドメインに限定されていません、したがって、複数のドメインを保護するために使用できます。 一般的に、１つのドメインのみを保護するインストール、私たちは「単一ドメイン・インストール」と呼んでいますで、複数のドメイン/サブドメインを保護するインストール、私たちは「マルチドメイン・インストール」と呼んでいます。 マルチドメインインストールを使用している場合で、異なるドメインに異なるシグネチャ・ファイルセットを使用する必要がある場合や、異なるドメインにphpMusselを異なる設定する必要があります、これを行うことができます。 コンフィグレーション・ファイルをロードした後（`config.ini`）、phpMusselは、要求されたドメインの「コンフィグレーション・オーバーライド・ファイル」の存在をチェックします (`xn--48jua8kwd4hof5er493ch97b.tld.config.ini`)、そして見つかった場合、コンフィグレーション・オーバーライド・ファイルによって定義された構成値は、コンフィグレーション・ファイルによって定義された構成値ではなく、実行インスタンスに使用されます。 コンフィグレーション・オーバーライド・ファイルは、コンフィグレーション・ファイルと同じです。 お客様の裁量で、phpMusselで利用可能なすべての設定指示句の全体または必要なサブセクションを含めることができます。 コンフィグレーション・オーバーライド・ファイルは彼らが意図しているドメインに従って命名されます （そう、例えば、ドメイン`http://www.some-domain.tld/`にコンフィグレーション・オーバーライド・ファイルが必要な場合は、コンフィグレーション・オーバーライド・ファイルの名前は`some-domain.tld.config.ini`にする必要があります。 通常の設定ファイルと同じ場所に保存する必要があります）。 ドメイン名は `HTTP_HOST` から来ます。 "www"は無視されます。

---


最終アップデート： 2017年5月19日。
